{
    "collab_server" : "",
    "contents" : "library(devtools)\n#install_github('arilamstein/choroplethrZip@v1.3.0')\nlibrary(choroplethrZip)\nlibrary(shiny)\nlibrary(leaflet)\nlibrary(RColorBrewer)\nlibrary(scales)\nlibrary(lattice)\nlibrary(dplyr)\n\n\nshinyServer(function(input, output, session) {\n        \n        ## Interactive Map ###########################################\n        \n        # Create the map\n        output$map <- renderLeaflet({\n                leaflet() %>%\n                        addTiles(\n                                urlTemplate = \"https://api.mapbox.com/v4/mapbox.dark/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZnJhcG9sZW9uIiwiYSI6ImNpa3Q0cXB5bTAwMXh2Zm0zczY1YTNkd2IifQ.rjnjTyXhXymaeYG6r2pclQ\"\n                                #urlTemplate = \"//{s}.tiles.mapbox.com/v3/jcheng.map-5ebohr46/{z}/{x}/{y}.png\",\n                                #attribution = 'Maps by <a href=\"http://www.mapbox.com/\">Mapbox</a>'\n                        ) %>%\n                        setView(lng = -73.97, lat = 40.75, zoom = 13)\n        })\n        \n        \n        # Select crime type, multiple selections are allowed\n#        ctype1 <- reactive({\n#                if (input$crime == '') {\n#                        return(crime)\n#                }\n#                else {\n#                t <- filter(crime, Offense == input$crime)\n#                return(t)\n#        }})\n#        \n#        ctype2 <- reactive({\n#                if (input$month == '') {\n#                        return(ctype1())\n#                }\n#                else {\n#                        t <- filter(ctype1(), Occurrence.Month == input$month)\n#                        return(t)\n#                }})\n#        \n#        ctype3 <- reactive({\n#                if (input$day == '') {\n#                        return(ctype2())\n#                }\n#                else {\n#                        t <- filter(ctype2(), Occurrence.Day == input$day)\n#                        return(t)\n#                }})\n#        \n#        ctype4 <- reactive({\n#                if (input$hour == '') {\n#                        return(ctype3())\n#                }\n#                else {\n#                        t <- filter(ctype3(), Occurrence.Hour == input$hour)\n#                        return(t)\n#                }})\n\n        cdata <- reactive({\n                draw <- crime\n                if (input$crime != '') {\n                        t <- filter(draw, Offense == input$crime)\n                        draw <- t\n                }\n                \n                if (input$month != '') {\n                        t <- filter(draw, Occurrence.Month == input$month)\n                        draw <- t\n                }\n                \n                if (input$day != '') {\n                        t <- filter(draw, Occurrence.Day == input$day)\n                        draw <- t\n                }\n                \n                if (input$hour != '') {\n                        t <- filter(draw, Occurrence.Hour == input$hour)\n                        draw <- t\n                }\n                \n                return(draw)\n        })\n        \n        \n        \n        \n                \n        #colorBy <- input$crime\n        #colorData <- ctype1()[[colorBy]]\n        # Add crime circles to map \n        \n        observe({  \n                #pal <- \"red\"\n                pal <- colorFactor(palette()[-1], levels(crime$Offense))\n                Radius <- 10\n                leafletProxy(\"map\", data = cdata()) %>%\n                        clearShapes() %>%\n                        #showGroup('crime') %>%\n                        addCircles(~Long, ~Lat, radius = Radius, stroke = FALSE, fillOpacity = 0.8, fillColor = pal(cdata()[[\"Offense\"]]))\n                        #addLegend(\"bottomleft\", pal=pal, values=draw[[\"crime\"]], title=\"crime\",\n                        #  layerId=\"colorLegend\")\n        }) \n        \n        \n})\n",
    "created" : 1455893004833.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1421775846",
    "id" : "16211FA8",
    "lastKnownWriteTime" : 1456014478,
    "last_content_update" : 1456014478312,
    "path" : "~/Desktop/森哥文档（硕士）/2nd semester/ADS/project 2/Restroom and Crime/server.R",
    "project_path" : "server.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}